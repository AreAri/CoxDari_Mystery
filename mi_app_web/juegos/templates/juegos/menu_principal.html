{% load static %}
{% load custom_filters %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>MenÃº Principal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f0f4f8;
        }

        .capitulo-titulo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-top: 2rem;
        }

        .nivel-card {
            width: 140px;
            height: 140px;
            margin: 10px;
            border-radius: 20px;
            transition: transform 0.3s ease;
        }

        .nivel-card:hover {
            transform: scale(1.05);
        }

        .bloqueado {
            background-color: #e0e0e0;
            color: #aaa;
            pointer-events: none;
            cursor: not-allowed;
        }

        .desbloqueado {
            background-color: #ffffff;
            color: #000;
            border: 2px solid #0d6efd;
        }

        .completado {
            background-color: #d1e7dd;
            border: 2px solid #198754;
            color: #198754;
        }

        .icono-tipo {
            font-size: 1.5rem;
        }

        .nivel-titulo {
            font-weight: bold;
            font-size: 1rem;
        }

        .estado-texto {
            font-size: 0.85rem;
        }

        .scroll-x {
            overflow-x: auto;
            white-space: nowrap;
        }

        .nivel-contenedor {
            display: inline-flex;
        }
    </style>
</head>
<body>

<div class="container py-4">
    <h2 class="text-center mb-4">Â¡Bienvenido {{ username }}!</h2>
    <div class="text-center mb-4">
        <span class="badge bg-primary">Rango: {{ rango }}</span>
        <span class="badge bg-success">Exp: {{ exp }}</span>
        <span class="badge bg-info text-dark">CapÃ­tulo actual: {{ capitulo }}</span>
        <span class="badge bg-warning text-dark">Nivel actual: {{ nivel }}</span>
    </div>

    {% for capitulo in niveles_data|agrupar_por:"capitulo" %}
        <div class="capitulo-titulo">{{ capitulo.grouper }}</div>
        <div class="scroll-x">
            <div class="nivel-contenedor">
                {% for nivel in capitulo.list %}
                    <div class="card nivel-card 
                        {% if nivel.completado %}completado
                        {% elif nivel.desbloqueado %}desbloqueado
                        {% else %}bloqueado{% endif %}">
                        <div class="card-body d-flex flex-column justify-content-center text-center">
                            <div class="icono-tipo">
                                {% if nivel.tipo == "Teoria" %}ðŸ“˜
                                {% elif nivel.tipo == "Ejercicio" %}ðŸ§©
                                {% elif nivel.tipo == "Desafio" %}ðŸ”¥
                                {% endif %}
                            </div>
                            <div class="nivel-titulo">{{ nivel.titulo }}</div>
                            <div class="estado-texto">
                                {% if nivel.completado %}
                                    âœ… Completado
                                {% elif nivel.desbloqueado %}
                                    ðŸ”“ Desbloqueado
                                {% else %}
                                    ðŸ”’ Bloqueado
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
